"0","pc.percent[1:2] %>% sum() # total percent explained by PCs 1 & 2"
"1","[1]"
"1"," 70.42047"
"1","
"
"0","#### Generate dataframe with prcomp results "
"0","pc.scores.sex <- data.frame(sample.id = colnames(sex.cov),"
"0","  PC1 = pca.sex$rotation[,1],    # the first eigenvector"
"0","  PC2 = pca.sex$rotation[,2],    # the second eigenvector"
"0","  PC3 = pca.sex$rotation[,3],    # the third eigenvector"
"0","  PC4 = pca.sex$rotation[,4],    # the fourth eigenvector"
"0","  PC5 = pca.sex$rotation[,5],    # the fourth eigenvector"
"0","  PC6 = pca.sex$rotation[,6],    # the fourth eigenvector"
"0","  stringsAsFactors = FALSE)"
"0",""
"0","# Add metadata"
"0","pc.scores.sex <- left_join(pc.scores.sex, ref.sex,by=c(""sample.id""=""sample""))"
"0","axes <- data.frame(""pc.x""=c(1,1,2), "
"0","                   ""pc.y""=c(2,3,3)) %>%"
"0","  mutate(pc.x=paste(""PC"", pc.x, sep=""""), pc.y=paste(""PC"", pc.y, sep=""""))"
"0",""
"0","# Variance explained by each PC axis"
"0","variance <- pc.percent %>% as.data.frame() %>% set_names(""variance"") %>% rownames_to_column(""axis"") %>% "
"0","  filter(axis %in% c(""PC1"", ""PC2"", ""PC3"")) #%>%"
"0",""
"0","# Plot PC biplots for axes 1-3"
"0","#ggplotly("
"0","  ggscatter(pc.scores.sex,"
"0","            group=c(""sex""), col=""sex"", text=""sample.id"","
"0","            x=axes[1,""pc.x""], y=axes[1,""pc.y""], size=1.5, alpha=0.85, "
"0","            ellipse = T, star.plot = F) +"
"0","    theme_minimal() + ggtitle(""Global gene expression PC1xPC2"") + "
"0","    ylab(paste(axes[1, ""pc.y""], "" ("", round(variance[variance$axis==axes[1, ""pc.y""], ""variance""], digits = 2), ""%)"", sep="""")) + "
"0","    xlab(paste(axes[1, ""pc.x""], "" ("", round(variance[variance$axis==axes[1, ""pc.x""], ""variance""], digits = 2), ""%)"", sep="""")) + "
"0","    theme(legend.position = ""bottom"", legend.text=element_text(size=8), legend.title=element_text(size=9)) + "
"0","      scale_color_manual(name=""Sex"",  values=c(""male""=""#2c7bb6"", ""female""=""#d7191c"")) +"
"0","      scale_fill_manual(guide=F, values=c(""male""=""#2c7bb6"", ""female""=""#d7191c"")) +"
"0","      ggtitle(paste(""PCA using putative sex markers in Pacific cod\n"", axes[1, ""pc.y""], ""x"", axes[1, ""pc.x""], sep="" "")) + facet_wrap(~marine_region) #, "
